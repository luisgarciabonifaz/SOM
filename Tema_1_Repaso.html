<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actividades de Repaso RA1: Fundamentos de Sistemas Operativos</title>
    <!-- Carga de Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para la fuente "Inter" y otros ajustes */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Un gris claro azulado */
            color: #334155; /* Texto principal en gris oscuro */
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        #app-container {
            max-width: 960px;
            width: 95%;
            margin: 2rem auto;
            background-color: #ffffff;
            border-radius: 1rem; /* Esquinas más redondeadas */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        /* Estilos para botones de navegación y acciones */
        .btn-primary {
            @apply bg-blue-600 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75;
        }
        .btn-secondary {
            @apply bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg shadow-md hover:bg-gray-400 transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-75;
        }
        .correct-answer {
            @apply border-2 border-green-500 bg-green-100 text-green-800;
        }
        .incorrect-answer {
            @apply border-2 border-red-500 bg-red-100 text-red-800;
        }
        .correct-feedback {
            @apply text-green-700 font-semibold mt-1;
        }
        .incorrect-feedback {
            @apply text-red-700 font-semibold mt-1;
        }
        .answer-explanation {
            @apply text-gray-600 text-sm mt-1 italic;
        }
    </style>
</head>
<body class="font-sans">
    <div id="app-container" class="p-8">
        <header class="flex flex-col sm:flex-row items-center justify-center sm:justify-start mb-8 rounded-lg p-4 bg-blue-50 shadow-md">
            <!-- Logo y texto del curso -->
            <img src="logo.png" alt="CIPFP Mislata Logo" class="h-16 w-16 object-contain mr-4 mb-4 sm:mb-0" onerror="this.onerror=null; this.src='https://placehold.co/64x64/E0F2FE/1E40AF?text=LOGO';">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-800 text-center sm:text-left">
                SMR - Sistemas Operativos Monopuesto
            </h1>
        </header>


        <h1 class="text-4xl font-extrabold text-center text-blue-800 mb-8 rounded-lg p-4 bg-blue-50">
            Actividades de Repaso RA1: Fundamentos de Sistemas Operativos
        </h1>

        <nav class="mb-8 p-4 bg-gray-100 rounded-lg shadow-inner flex flex-wrap justify-center gap-4">
            <button id="nav-quiz" class="btn-secondary">Cuestionario de Múltiple Opción</button>
            <button id="nav-fill-blanks" class="btn-secondary">Completar la Frase</button>
        </nav>

        <div id="activity-content" class="min-h-[400px]">
            <!-- El contenido de la actividad se cargará aquí -->
            <p class="text-center text-lg text-gray-600">
                Selecciona una actividad del menú superior para empezar el repaso.
            </p>
        </div>

        <div id="results-summary" class="mt-8 p-6 bg-blue-50 border border-blue-200 rounded-lg hidden">
            <h2 class="text-2xl font-bold text-blue-700 mb-4 text-center">Resumen de Resultados</h2>
            <div id="score-display" class="text-center text-xl font-semibold mb-4"></div>
            <div id="detailed-results" class="space-y-4"></div>
            <button id="restart-activity" class="btn-primary w-full mt-6">Reiniciar Actividad</button>
        </div>
    </div>

    <script>
        // Datos de las actividades
        const activities = {
            "quiz": {
                "title": "Cuestionario de Múltiple Opción",
                "type": "quiz",
                "questions": [
                    {
                        "id": "q1",
                        "text": "¿Qué componente es el 'cerebro' del ordenador, encargado de ejecutar las instrucciones de los programas?",
                        "options": ["Memoria RAM", "CPU", "Disco Duro", "Tarjeta de Red"],
                        "answer": "CPU",
                        "section": "1.1. Elementos Funcionales",
                        "explanation": "La CPU (Unidad Central de Procesamiento) es responsable de ejecutar todas las instrucciones del software."
                    },
                    {
                        "id": "q2",
                        "text": "¿Cuál de estos es un periférico de salida?",
                        "options": ["Teclado", "Micrófono", "Monitor", "Ratón"],
                        "answer": "Monitor",
                        "section": "1.1. Elementos Funcionales",
                        "explanation": "Un monitor muestra información del ordenador al usuario, siendo un periférico de salida."
                    },
                    {
                        "id": "q3",
                        "text": "¿Qué sistema de numeración utiliza solo los dígitos 0 y 1?",
                        "options": ["Decimal", "Hexadecimal", "Octal", "Binario"],
                        "answer": "Binario",
                        "section": "1.2. Sistemas de Representación",
                        "explanation": "El sistema binario es la base de la comunicación y procesamiento de información en los ordenadores."
                    },
                    {
                        "id": "q4",
                        "text": "¿Cuál de los siguientes estándares de codificación de caracteres es más moderno y soporta más idiomas?",
                        "options": ["ASCII", "EBCDIC", "Unicode", "ISO-8859-1"],
                        "answer": "Unicode",
                        "section": "1.2. Sistemas de Representación",
                        "explanation": "Unicode es un estándar global que permite representar caracteres de prácticamente todos los sistemas de escritura del mundo."
                    },
                    {
                        "id": "q5",
                        "text": "Cuando un proceso está esperando que ocurra una operación de E/S (entrada/salida), ¿en qué estado se encuentra?",
                        "options": ["En Ejecución", "Listo", "Nuevo", "Bloqueado/En Espera"],
                        "answer": "Bloqueado/En Espera",
                        "section": "1.3. Procesos y sus Estados",
                        "explanation": "Un proceso pasa al estado 'Bloqueado/En Espera' cuando necesita que un evento externo se complete para continuar."
                    },
                    {
                        "id": "q6",
                        "text": "¿Cuál es el sistema de archivos predeterminado en Windows que ofrece mayor seguridad y soporte para archivos grandes?",
                        "options": ["FAT32", "ext4", "NTFS", "HFS+"],
                        "answer": "NTFS",
                        "section": "1.4. Sistema de Archivos",
                        "explanation": "NTFS (New Technology File System) es el sistema de archivos estándar de Windows, con características avanzadas de seguridad y gestión."
                    },
                    {
                        "id": "q7",
                        "text": "En Linux, ¿qué carácter representa la raíz del sistema de archivos?",
                        "options": ["C:\\", "/mnt", "/", "~"],
                        "answer": "/",
                        "section": "1.4. Sistema de Archivos",
                        "explanation": "En Linux, '/' es el directorio raíz, del cual descienden todos los demás directorios y archivos."
                    },
                    {
                        "id": "q8",
                        "text": "¿Qué atributo de un archivo indica que no puede ser modificado ni eliminado?",
                        "options": ["Oculto", "Sistema", "Archivo", "Solo Lectura"],
                        "answer": "Solo Lectura",
                        "section": "1.5. Atributos",
                        "explanation": "El atributo 'Solo Lectura' protege el archivo de cambios accidentales o no autorizados."
                    },
                    {
                        "id": "q9",
                        "text": "En los permisos de archivos en Linux, ¿qué significa el permiso de 'ejecución' (X) para un directorio?",
                        "options": ["Permite listar su contenido", "Permite eliminarlo", "Permite entrar en el directorio", "Permite modificar su nombre"],
                        "answer": "Permite entrar en el directorio",
                        "section": "1.6. Permisos",
                        "explanation": "Para poder acceder al contenido de un directorio o a sus subdirectorios, se necesita el permiso de ejecución sobre él."
                    },
                    {
                        "id": "q10",
                        "text": "¿Qué mecanismo en los sistemas de archivos modernos ayuda a recuperar la consistencia de los datos después de un fallo inesperado (como un apagón)?",
                        "options": ["Desfragmentación", "Cifrado", "Journaling", "Compresión"],
                        "answer": "Journaling",
                        "section": "1.7. Sistemas Transaccionales",
                        "explanation": "El Journaling registra las operaciones de escritura antes de realizarlas, permitiendo una recuperación eficiente del sistema de archivos tras un fallo."
                    }
                ]
            },
            "fill_in_the_blanks": {
                "title": "Completar la Frase",
                "type": "fill_in_the_blanks",
                "questions": [
                    {
                        "id": "fb1",
                        "text": "Un ________ es la ejecución activa de un programa.",
                        "answer": "proceso",
                        "section": "1.3. Procesos y sus Estados",
                        "explanation": "Un proceso es una instancia de un programa en ejecución con sus propios recursos."
                    },
                    {
                        "id": "fb2",
                        "text": "El sistema de archivos _______ es el predeterminado para Windows, ofreciendo alta seguridad y soporte para archivos grandes.",
                        "answer": "NTFS",
                        "section": "1.4. Sistema de Archivos",
                        "explanation": "NTFS es el sistema de archivos estándar y más robusto en entornos Windows."
                    },
                    {
                        "id": "fb3",
                        "text": "El atributo _________ indica que un archivo o directorio no se muestra por defecto en las vistas del sistema.",
                        "answer": "oculto",
                        "section": "1.5. Atributos",
                        "explanation": "Los archivos ocultos no son visibles a menos que se configure el explorador de archivos para mostrarlos."
                    },
                    {
                        "id": "fb4",
                        "text": "En el modelo de permisos, el _________ es el usuario que creó el archivo o directorio.",
                        "answer": "propietario",
                        "section": "1.6. Permisos",
                        "explanation": "El propietario de un archivo o directorio es el usuario que lo creó y tiene control sobre sus permisos."
                    },
                    {
                        "id": "fb5",
                        "text": "El _________ (registro por diario) es un mecanismo que asegura la consistencia del sistema de archivos después de un fallo.",
                        "answer": "Journaling",
                        "section": "1.7. Sistemas Transaccionales",
                        "explanation": "El Journaling previene la corrupción del sistema de archivos al registrar las operaciones antes de ejecutarlas."
                    },
                    {
                        "id": "fb6",
                        "text": "Los _________ son el software que permite al sistema operativo comunicarse con un hardware específico.",
                        "answer": "drivers/controladores",
                        "section": "1.1. Elementos Funcionales",
                        "explanation": "Los drivers son esenciales para que el hardware funcione correctamente con el SO."
                    },
                    {
                        "id": "fb7",
                        "text": "La memoria _________ es volátil y guarda los datos y programas en uso activo.",
                        "answer": "RAM",
                        "section": "1.1. Elementos Funcionales",
                        "explanation": "La RAM es la memoria principal de acceso rápido utilizada para los programas en ejecución."
                    },
                    {
                        "id": "fb8",
                        "text": "La unidad mínima de información en un ordenador es un _________ (dígito binario).",
                        "answer": "bit",
                        "section": "1.2. Sistemas de Representación",
                        "explanation": "Un bit (0 o 1) es la unidad más pequeña de información digital."
                    }
                ]
            }
        };

        let currentActivity = null;
        let userAnswers = {}; // Para almacenar las respuestas del usuario

        const activityContentDiv = document.getElementById('activity-content');
        const resultsSummaryDiv = document.getElementById('results-summary');
        const scoreDisplayDiv = document.getElementById('score-display');
        const detailedResultsDiv = document.getElementById('detailed-results');
        const navQuizBtn = document.getElementById('nav-quiz');
        const navFillBlanksBtn = document.getElementById('nav-fill-blanks');
        const restartActivityBtn = document.getElementById('restart-activity');


        // Función para limpiar el contenido y ocultar resultados
        function resetActivityDisplay() {
            activityContentDiv.innerHTML = '';
            resultsSummaryDiv.classList.add('hidden');
            detailedResultsDiv.innerHTML = '';
            scoreDisplayDiv.innerHTML = '';
            userAnswers = {}; // Reiniciar respuestas del usuario
        }

        // --- Renderizado de Actividades ---

        // Renderiza el cuestionario de múltiple opción
        function renderQuiz(activityData) {
            resetActivityDisplay();
            currentActivity = activityData;

            let htmlContent = `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">${activityData.title}</h2>
                <form id="quiz-form" class="space-y-6">
            `;

            activityData.questions.forEach((q, index) => {
                htmlContent += `
                    <div class="p-5 border border-gray-200 rounded-lg shadow-sm bg-white">
                        <p class="text-lg font-semibold mb-3 text-gray-700">
                            ${index + 1}. (${q.section}) ${q.text}
                        </p>
                        <div class="space-y-2">
                `;
                q.options.forEach(option => {
                    htmlContent += `
                        <label class="flex items-center p-3 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition duration-150 ease-in-out">
                            <input type="radio" name="${q.id}" value="${option}" class="form-radio h-4 w-4 text-blue-600 focus:ring-blue-500 mr-3">
                            <span class="text-gray-900">${option}</span>
                        </label>
                    `;
                });
                htmlContent += `
                        </div>
                        <div id="feedback-${q.id}" class="mt-2 text-sm"></div>
                    </div>
                `;
            });

            htmlContent += `
                    <button type="submit" class="btn-primary w-full mt-8">Comprobar Respuestas</button>
                </form>
            `;
            activityContentDiv.innerHTML = htmlContent;

            document.getElementById('quiz-form').addEventListener('submit', function(event) {
                event.preventDefault();
                checkQuizAnswers(activityData.questions);
            });
        }

        // Renderiza la actividad de completar la frase
        function renderFillInTheBlanks(activityData) {
            resetActivityDisplay();
            currentActivity = activityData;

            let htmlContent = `
                <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">${activityData.title}</h2>
                <form id="fill-blanks-form" class="space-y-6">
            `;

            activityData.questions.forEach((q, index) => {
                // Reemplaza el placeholder con un input
                const textWithInput = q.text.replace('_________', `<input type="text" id="${q.id}" class="form-input mt-1 block w-auto border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50 inline-block align-middle p-2">`);
                htmlContent += `
                    <div class="p-5 border border-gray-200 rounded-lg shadow-sm bg-white">
                        <p class="text-lg font-semibold mb-3 text-gray-700">
                            ${index + 1}. (${q.section}) ${textWithInput}
                        </p>
                        <div id="feedback-${q.id}" class="mt-2 text-sm"></div>
                    </div>
                `;
            });

            htmlContent += `
                    <button type="submit" class="btn-primary w-full mt-8">Comprobar Respuestas</button>
                </form>
            `;
            activityContentDiv.innerHTML = htmlContent;

            document.getElementById('fill-blanks-form').addEventListener('submit', function(event) {
                event.preventDefault();
                checkFillBlanksAnswers(activityData.questions);
            });
        }

        // --- Funciones de Verificación ---

        // Verifica las respuestas del cuestionario de múltiple opción
        function checkQuizAnswers(questions) {
            let correctCount = 0;
            userAnswers = {}; // Reiniciar para esta verificación

            questions.forEach(q => {
                const selectedOption = document.querySelector(`input[name="${q.id}"]:checked`);
                const feedbackDiv = document.getElementById(`feedback-${q.id}`);

                // Limpiar clases y feedback anterior
                feedbackDiv.innerHTML = '';
                const labels = document.querySelectorAll(`input[name="${q.id}"]`).forEach(input => {
                    input.parentElement.classList.remove('correct-answer', 'incorrect-answer');
                });

                if (selectedOption) {
                    userAnswers[q.id] = selectedOption.value;
                    if (selectedOption.value === q.answer) {
                        correctCount++;
                        feedbackDiv.innerHTML = `<span class="correct-feedback">¡Correcto!</span>`;
                        selectedOption.parentElement.classList.add('correct-answer');
                    } else {
                        feedbackDiv.innerHTML = `
                            <span class="incorrect-feedback">Incorrecto. La respuesta correcta es: <strong>${q.answer}</strong>.</span>
                            <p class="answer-explanation">${q.explanation}</p>
                        `;
                        selectedOption.parentElement.classList.add('incorrect-answer');
                        // Mostrar la opción correcta también
                        document.querySelector(`input[name="${q.id}"][value="${q.answer}"]`).parentElement.classList.add('correct-answer');
                    }
                } else {
                    userAnswers[q.id] = null; // No answer provided
                    feedbackDiv.innerHTML = `
                        <span class="incorrect-feedback">No has seleccionado ninguna respuesta. La correcta es: <strong>${q.answer}</strong>.</span>
                        <p class="answer-explanation">${q.explanation}</p>
                    `;
                     document.querySelector(`input[name="${q.id}"][value="${q.answer}"]`).parentElement.classList.add('correct-answer');
                }
            });

            showResults(correctCount, questions.length);
        }

        // Verifica las respuestas de completar la frase
        function checkFillBlanksAnswers(questions) {
            let correctCount = 0;
            userAnswers = {}; // Reiniciar para esta verificación

            questions.forEach(q => {
                const inputElement = document.getElementById(q.id);
                const userAnswer = inputElement.value.trim().toLowerCase();
                const correctAnswers = Array.isArray(q.answer) ? q.answer.map(a => a.toLowerCase()) : [q.answer.toLowerCase()];

                const feedbackDiv = document.getElementById(`feedback-${q.id}`);
                feedbackDiv.innerHTML = '';
                inputElement.classList.remove('correct-answer', 'incorrect-answer');

                userAnswers[q.id] = userAnswer;

                if (correctAnswers.includes(userAnswer)) {
                    correctCount++;
                    feedbackDiv.innerHTML = `<span class="correct-feedback">¡Correcto!</span>`;
                    inputElement.classList.add('correct-answer');
                } else {
                    feedbackDiv.innerHTML = `
                        <span class="incorrect-feedback">Incorrecto. La respuesta correcta es: <strong>${q.answer}</strong>.</span>
                        <p class="answer-explanation">${q.explanation}</p>
                    `;
                    inputElement.classList.add('incorrect-answer');
                }
            });

            showResults(correctCount, questions.length);
        }

        // --- Mostrar Resultados ---

        function showResults(correct, total) {
            scoreDisplayDiv.innerHTML = `Has obtenido ${correct} de ${total} respuestas correctas.`;
            detailedResultsDiv.innerHTML = ''; // Limpiar resultados anteriores

            const questionsToShow = currentActivity.questions;

            questionsToShow.forEach((q, index) => {
                let userAnswer = userAnswers[q.id];
                let isCorrect;
                let correctDisplayAnswer;

                if (currentActivity.type === 'quiz') {
                    isCorrect = (userAnswer === q.answer);
                    correctDisplayAnswer = q.answer;
                    if (userAnswer === null) userAnswer = "No respondida"; // Para preguntas sin respuesta
                } else if (currentActivity.type === 'fill_in_the_blanks') {
                    const correctAnswers = Array.isArray(q.answer) ? q.answer.map(a => a.toLowerCase()) : [q.answer.toLowerCase()];
                    isCorrect = correctAnswers.includes(userAnswer.toLowerCase());
                    correctDisplayAnswer = Array.isArray(q.answer) ? q.answer.join(" / ") : q.answer;
                }

                detailedResultsDiv.innerHTML += `
                    <div class="p-4 border rounded-lg ${isCorrect ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}">
                        <p class="font-semibold">${index + 1}. ${q.text}</p>
                        <p class="mt-1">Tu respuesta: <span class="${isCorrect ? 'text-green-700' : 'text-red-700 font-bold'}">${userAnswer || 'No respondida'}</span></p>
                        ${!isCorrect ? `<p class="mt-1">Respuesta correcta: <span class="text-green-700 font-bold">${correctDisplayAnswer}</span></p>` : ''}
                        <p class="answer-explanation">${q.explanation}</p>
                    </div>
                `;
            });

            resultsSummaryDiv.classList.remove('hidden');
            // Desplazarse suavemente hasta la sección de resultados
            resultsSummaryDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- Manejadores de Eventos de Navegación ---
        navQuizBtn.addEventListener('click', () => renderQuiz(activities.quiz));
        navFillBlanksBtn.addEventListener('click', () => renderFillInTheBlanks(activities.fill_in_the_blanks));
        restartActivityBtn.addEventListener('click', () => {
            if (currentActivity) {
                if (currentActivity.type === 'quiz') {
                    renderQuiz(currentActivity);
                } else if (currentActivity.type === 'fill_in_the_blanks') {
                    renderFillInTheBlanks(currentActivity);
                }
            }
        });

        // Inicializar la aplicación al cargar la página (opcional, para cargar una actividad por defecto)
        window.onload = function() {
            // Podrías cargar una actividad por defecto al inicio, por ejemplo:
            // renderQuiz(activities.quiz);
        };
    </script>
</body>
</html>

